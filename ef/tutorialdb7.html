<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><title>Select</title><link rel="stylesheet" href="highlighter/default.css">
<link rel="stylesheet" href="res/styles.css">
<link rel="stylesheet" href="res/dripicons.css"></head><body><script type="text/javascript" src="highlighter/highlight.pack.js"></script><script type="text/javascript" src="highlighter/highlight.cshtml.js"></script><script type="text/javascript" src="settings.js"></script><script type="text/javascript" src="res/page-scripts.js"></script><script type="text/javascript">
    loadStarted();
</script><h1>Select</h1><p><b>Simple Select</b></p>
<p>To build a <code class="ctag">SELECT</code> query use <a href="Gehtsoft.EF.Db.SqlDb.QueryBuilder.SelectQueryBuilder.html"><code>SelectQueryBuilder</code></a>.
You can specify resultset, filter and ordering using methods available in this class. Below is an example of a simple single-table select
with simple filter and simple order.</p><div id="open11" style="display:none">
  <p>Example: Simple Select&nbsp;<a href="javascript: showdiv('close11'); hidediv('open11');" onclick="javascript: showdiv('close11'); hidediv('open11');" class="action">Show<span class="side-icon dripicons-chevron-right"></span></a></p>
</div>
<div id="close11" style="display:inline">
  <p>Example: Simple Select&nbsp;<a href="javascript: showdiv('open11'); hidediv('close11');" onclick="javascript: showdiv('open11'); hidediv('close11');" class="action">Hide<span class="side-icon dripicons-chevron-down"></span></a></p>
  <pre class="example" id="example11"><code class="cs">SelectQueryBuilder builder = connection.GetSelectQueryBuilder(my_table);
builder.AddToResultset(my_table[&quot;id&quot;]);
builder.AddToResultset(my_table[&quot;name&quot;]);
builder.AddToResultset(my_table[&quot;volume&quot;]);
builder.Where.Property(my_table[&quot;volume&quot;]).Is(CmpOp.Ge).Parameter(&quot;volume&quot;);
builder.AddOrderBy(my_table[&quot;name&quot;]);
using (SqlDbQuery query = connection.GetQuery(builder))
{
    query.BindParam(&quot;volume&quot;, 10);
    query.ExecuteReader();
    while (query.ReadNext())
    {
        ...
    }
}</code></pre>
</div><p><b>Joining tables</b></p>
<p>Use the method
<a href="Gehtsoft.EF.Db.SqlDb.QueryBuilder.SelectQueryBuilder.AddTable.7v7.html"><code>AddTable</code></a>
to add a table to the query.
In the most cases the table to be added has foreign key relationship to one of the tables in
the query, so you don't have to specify the exact join condition. However, in case the tables
do not have exactly defined relationships, you can always
disable automatic table connecting and condigure join
via <a href="Gehtsoft.EF.Db.SqlDb.QueryBuilder.QueryBuilderEntity.html"><code>QueryBuilderEntity</code></a> or
simply use <a href="Gehtsoft.EF.Db.SqlDb.QueryBuilder.QueryWithWhereBuilder.Where.4CB.html"><code>Where</code></a>
of the query to define join condition SQL89-style.</p><div id="open12" style="display:none">
  <p>Example: Simple Select&nbsp;<a href="javascript: showdiv('close12'); hidediv('open12');" onclick="javascript: showdiv('close12'); hidediv('open12');" class="action">Show<span class="side-icon dripicons-chevron-right"></span></a></p>
</div>
<div id="close12" style="display:inline">
  <p>Example: Simple Select&nbsp;<a href="javascript: showdiv('open12'); hidediv('close12');" onclick="javascript: showdiv('open12'); hidediv('close12');" class="action">Hide<span class="side-icon dripicons-chevron-down"></span></a></p>
  <pre class="example" id="example12"><code class="cs">SelectQueryBuilder builder = connection.GetSelectQueryBuilder(my_table);
builder.AddToResultset(my_table[&quot;id&quot;]);
builder.AddToResultset(my_table[&quot;name&quot;]);
builder.AddToResultset(my_table[&quot;volume&quot;]);
builder.Where.Property(my_table[&quot;volume&quot;].Is(CmpOp.Ge).Parameter(&quot;volume&quot;);
builder.AddOrderBy(my_table[&quot;name&quot;]);
        
builder.AddTable(my_dictionary, true);
builder.AddToResultset(my_dictionary[&quot;name&quot;], &quot;reference_name&quot;);
        
using (SqlDbQuery query = connection.GetQuery(builder))
{
    query.BindParam(&quot;volume&quot;, 10);
    query.ExecuteReader();
    while (query.ReadNext())
    {
        ...
    }
}</code></pre>
</div><p><b>More Examples</b></p>
<p>There are a few more self-explaining examples of using SELECT query.</p><div id="open13" style="display:none">
  <p>Example: Using Aggregate Functions&nbsp;<a href="javascript: showdiv('close13'); hidediv('open13');" onclick="javascript: showdiv('close13'); hidediv('open13');" class="action">Show<span class="side-icon dripicons-chevron-right"></span></a></p>
</div>
<div id="close13" style="display:inline">
  <p>Example: Using Aggregate Functions&nbsp;<a href="javascript: showdiv('open13'); hidediv('close13');" onclick="javascript: showdiv('open13'); hidediv('close13');" class="action">Hide<span class="side-icon dripicons-chevron-down"></span></a></p>
  <pre class="example" id="example13"><code class="cs">SelectQueryBuilder builder = connection.GetSelectQueryBuilder(my_dictionary);
        
builder.AddTable(my_table, true);
        
builder.AddToResultset(my_dictionary[&quot;name&quot;]);
builder.AddToResultset(AggFn.Max, my_table[&quot;volume&quot;]);
        
builder.AddOrderBy(my_dictionary[&quot;name&quot;]);
builder.AddGroupBy(my_dictionary[&quot;name&quot;]);
        
using (SqlDbQuery query = connection.GetQuery(builder))
{
    query.ExecuteReader();
    while (query.ReadNext())
    {
        ...
    }
}</code></pre>
</div><div id="open14" style="display:none">
  <p>Example: Using Simple Subqueries&nbsp;<a href="javascript: showdiv('close14'); hidediv('open14');" onclick="javascript: showdiv('close14'); hidediv('open14');" class="action">Show<span class="side-icon dripicons-chevron-right"></span></a></p>
</div>
<div id="close14" style="display:inline">
  <p>Example: Using Simple Subqueries&nbsp;<a href="javascript: showdiv('open14'); hidediv('close14');" onclick="javascript: showdiv('open14'); hidediv('close14');" class="action">Hide<span class="side-icon dripicons-chevron-down"></span></a></p>
  <pre class="example" id="example14"><code class="cs">//builder query SELECT id, name FROM my_table WHERE reference IN (SELECT id FROM my_dictionary WHERE name like @name_mask)&quot;
SelectQueryBuilder builder1 = connection.GetSelectQueryBuilder(my_dictionary);
builder1.AddToResultset(my_dictionary[&quot;id&quot;]);
builder1.Where.And().Property(my_dictionary[&quot;name&quot;]).Is(CmpOp.Like).Parameter(&quot;name_mask&quot;);
        
SelectQueryBuilder builder = connection.GetSelectQueryBuilder(my_table);
builder.AddToResultset(my_table[&quot;id&quot;]);
builder.AddToResultset(my_table[&quot;name&quot;]);
builder.Where.And().Property(my_table[&quot;reference&quot;]).Is(CmpOp.In).Query(builder1);
        
using (SqlDbQuery query = connection.GetQuery(builder))
{
    query.BindParam(&quot;name_mask&quot;, &quot;a%&quot;);
    query.ExecuteReader();
    while (query.ReadNext())
    {
        ...
    }
}</code></pre>
</div><p>Sometime subqueries require references to the parent queries.
In this case <a href="Gehtsoft.EF.Db.SqlDb.QueryBuilder.QueryWithWhereBuilder.GetReference.html"><code>GetReference()</code></a>
method may be used to get a reference for further usage in
<a href="Gehtsoft.EF.Db.SqlDb.EntityQueries.ConditionEntityQueryBase.Where.ty7.html"><code>Where</code></a> property.</p><div id="open15" style="display:none">
  <p>Example: Using Subqueries with References Between Queries&nbsp;<a href="javascript: showdiv('close15'); hidediv('open15');" onclick="javascript: showdiv('close15'); hidediv('open15');" class="action">Show<span class="side-icon dripicons-chevron-right"></span></a></p>
</div>
<div id="close15" style="display:inline">
  <p>Example: Using Subqueries with References Between Queries&nbsp;<a href="javascript: showdiv('open15'); hidediv('close15');" onclick="javascript: showdiv('open15'); hidediv('close15');" class="action">Hide<span class="side-icon dripicons-chevron-down"></span></a></p>
  <pre class="example" id="example15"><code class="cs">//builder query SELECT a.id, a.name FROM a.my_table WHERE a.volume &gt; (SELECT AVG(b.volume) FROM my_table b WHERE b.reference = a.reference)&quot;
SelectQueryBuilder builder = connection.GetSelectQueryBuilder(my_table);
builder.AddToResultset(my_table[&quot;id&quot;]);
builder.AddToResultset(my_table[&quot;name&quot;]);
        
SelectQueryBuilder builder1 = connection.GetSelectQueryBuilder(my_table);
builder1.AddToResultset(AggFn.Avg, my_table[&quot;volume&quot;]);
builder1.Where.And().Property(my_table[&quot;reference&quot;]).Is(CmpOp.Eq).Reference(builder.GetReference(my_table[&quot;reference&quot;]));
        
builder.Where.Property(my_table[&quot;volume&quot;]).Is(CmpOp.Gt).Query(builder1);
        
using (SqlDbQuery query = connection.GetQuery(builder))
{
    query.ExecuteReader();
    while (query.ReadNext())
    {
        ...
    }
}</code></pre>
</div><p>
  <center><a href="tutorialsdb.html">back</a></center>
</p><script language="javascript" type="text/javascript">syncList();</script></body></html>